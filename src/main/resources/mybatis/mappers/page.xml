<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.PageDAO">

	<sql id="criteria">

	 <if test='type == "T"'>
         where FAQ_TITLE like '%' || #{keyword} || '%'
      </if>
      <if test='type == "C"'>
         where FAQ_CONTENT like '%' || #{keyword} || '%'
      </if>
      <if test='type == "TC"'>
         where (FAQ_TITLE like '%' || #{keyword} || '%' or FAQ_CONTENT like '%' || #{keyword} || '%')
      </if>
		
	</sql>

    <select id="listWithPaging" resultType="com.boot.dto.FaQDTO">
    	<![CDATA[
		 SELECT FAQ_NO, FAQ_TITLE, FAQ_CONTENT
		FROM (
		    SELECT a.*, ROWNUM AS rnum
		    FROM (
		        SELECT FAQ_NO, FAQ_TITLE, FAQ_CONTENT
		        FROM TBL_FAQ
		]]>
		<include refid="criteria"></include>
		<![CDATA[
		        ORDER BY FAQ_NO DESC
		    ) a
		    WHERE ROWNUM <= (#{pageNum} * #{amount})
		)
		WHERE rnum > (#{pageNum}-1) * #{amount}
		]]>
    </select>
    
    
    <select id="getFaqDetail" resultType="com.boot.dto.FaQDTO" parameterType="int">
        SELECT 
            FAQ_NO, 
            FAQ_TITLE, 
            FAQ_CONTENT 
        FROM 
            TBL_FAQ 
        WHERE 
            FAQ_NO = #{faq_no}
    </select>
    
    <select id="getTotalCount" resultType="int">
		select count(*) from TBL_FAQ
		<include refid="criteria"></include>	  
    </select>

</mapper>





















