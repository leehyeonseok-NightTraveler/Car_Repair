<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.NoticeDAO">

    <!-- 공지사항 목록 페이징 조회 -->
    <select id="notice_list" resultType="com.boot.dto.NoticeDTO">
        <![CDATA[
        SELECT notice_no, notice_writer, notice_title, notice_created, notice_views
        FROM (
            SELECT rowNum AS rn, notice_no, notice_writer, notice_title, notice_created, notice_views
            FROM (
                SELECT notice_no, notice_writer, notice_title, notice_created, notice_views
                FROM tbl_notice
                ORDER BY notice_no DESC
            )
            WHERE rowNum <= #{pageNum} * #{amount}
        )
        WHERE rn > (#{pageNum} - 1) * #{amount}
        ]]>
    </select>

    <!-- 전체 공지사항 수 조회 -->
    <select id="notice_total" resultType="int">
        SELECT COUNT(*) FROM tbl_notice
    </select>

    <!-- 공지사항 상세 조회 -->
    <select id="notice_view" resultType="com.boot.dto.NoticeDTO">
        SELECT notice_no, notice_writer, notice_title, notice_content, notice_created, notice_views
        FROM tbl_notice
        WHERE notice_no = #{notice_no, jdbcType=INTEGER}
    </select>

    <!-- 공지사항 작성 -->
    <insert id="notice_write">
        INSERT INTO tbl_notice(notice_no, notice_title, notice_content)
        VALUES(SEQ_NOTICE_NO.NEXTVAL, #{notice_title}, #{notice_content})
    </insert>

    <!-- 공지사항 조회수 증가 -->
    <update id="increase_views">
        UPDATE tbl_notice
        SET notice_views = notice_views + 1
        WHERE notice_no = #{notice_no}
    </update>

    <!-- 공지사항 수정 -->
    <update id="notice_modify">
        UPDATE tbl_notice
        SET notice_title = #{notice_title},
        notice_content = #{notice_content}
        WHERE notice_no = #{notice_no, jdbcType=INTEGER}
    </update>

    <!-- 공지사항 삭제 -->
    <delete id="notice_delete">
        DELETE FROM tbl_notice
        WHERE notice_no = #{notice_no}
    </delete>

</mapper>